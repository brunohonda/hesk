!function(t,e){"function"==typeof define&&define.amd?define("sifter",e):"object"==typeof exports?module.exports=e():t.Sifter=e()}(this,function(){var t=function(t,e){this.items=t,this.settings=e||{diacritics:!0}};t.prototype.tokenize=function(t){if(!(t=s(String(t||"").toLowerCase()))||!t.length)return[];var e,i,n,r,l=[],p=t.split(/ +/);for(e=0,i=p.length;e<i;e++){if(n=o(p[e]),this.settings.diacritics)for(r in a)a.hasOwnProperty(r)&&(n=n.replace(RegExp(r,"g"),a[r]));l.push({string:p[e],regex:RegExp(n,"i")})}return l},t.prototype.iterator=function(t,e){var i;(i=r(t)?Array.prototype.forEach||function(t){for(var e=0,i=this.length;e<i;e++)t(this[e],e,this)}:function(t){for(var e in this)this.hasOwnProperty(e)&&t(this[e],e,this)}).apply(t,[e])},t.prototype.getScoreFunction=function(t,e){i=this,o=(t=i.prepareSearch(t,e)).tokens,s=t.options.fields,r=o.length,a=t.options.nesting;var i,s,o,r,a,l,p=function(t,e){var i,n;return t&&-1!==(n=(t=String(t||"")).search(e.regex))?(i=e.string.length/t.length,0===n&&(i+=.5),i):0},u=(l=s.length)?1===l?function(t,e){return p(n(e,s[0],a),t)}:function(t,e){for(var i=0,o=0;i<l;i++)o+=p(n(e,s[i],a),t);return o/l}:function(){return 0};return r?1===r?function(t){return u(o[0],t)}:"and"===t.options.conjunction?function(t){for(var e,i=0,n=0;i<r;i++){if((e=u(o[i],t))<=0)return 0;n+=e}return n/r}:function(t){for(var e=0,i=0;e<r;e++)i+=u(o[e],t);return i/r}:function(){return 0}},t.prototype.getSortFunction=function(t,i){var s,o,r,a,l,p,u,c,d,h,f;if(r=this,f=!(t=r.prepareSearch(t,i)).query&&i.sort_empty||i.sort,d=function(t,e){return"$score"===t?e.score:n(r.items[e.id],t,i.nesting)},l=[],f)for(s=0,o=f.length;s<o;s++)(t.query||"$score"!==f[s].field)&&l.push(f[s]);if(t.query){for(s=0,h=!0,o=l.length;s<o;s++)if("$score"===l[s].field){h=!1;break}h&&l.unshift({field:"$score",direction:"desc"})}else for(s=0,o=l.length;s<o;s++)if("$score"===l[s].field){l.splice(s,1);break}for(s=0,c=[],o=l.length;s<o;s++)c.push("desc"===l[s].direction?-1:1);return(p=l.length)?1===p?(a=l[0].field,u=c[0],function(t,i){return u*e(d(a,t),d(a,i))}):function(t,i){var n,s,o;for(n=0;n<p;n++)if(o=l[n].field,s=c[n]*e(d(o,t),d(o,i)))return s;return 0}:null},t.prototype.prepareSearch=function(t,e){if("object"==typeof t)return t;var n=(e=i({},e)).fields,s=e.sort,o=e.sort_empty;return n&&!r(n)&&(e.fields=[n]),s&&!r(s)&&(e.sort=[s]),o&&!r(o)&&(e.sort_empty=[o]),{options:e,query:String(t||"").toLowerCase(),tokens:this.tokenize(t),total:0,items:[]}},t.prototype.search=function(t,e){var i,n,s,o;return e=(o=this.prepareSearch(t,e)).options,t=o.query,n=e.score||this.getScoreFunction(o),t.length?this.iterator(this.items,function(t,i){s=n(t),(!1===e.filter||s>0)&&o.items.push({score:s,id:i})}):this.iterator(this.items,function(t,e){o.items.push({score:1,id:e})}),(i=this.getSortFunction(o,e))&&o.items.sort(i),o.total=o.items.length,"number"==typeof e.limit&&(o.items=o.items.slice(0,e.limit)),o};var e=function(t,e){return"number"==typeof t&&"number"==typeof e?t>e?1:t<e?-1:0:(t=l(String(t||"")))>(e=l(String(e||"")))?1:e>t?-1:0},i=function(t,e){var i,n,s,o;for(i=1,n=arguments.length;i<n;i++)if(o=arguments[i])for(s in o)o.hasOwnProperty(s)&&(t[s]=o[s]);return t},n=function(t,e,i){if(t&&e){if(!i)return t[e];for(var n=e.split(".");n.length&&(t=t[n.shift()]););return t}},s=function(t){return(t+"").replace(/^\s+|\s+$|/g,"")},o=function(t){return(t+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},r=Array.isArray||"undefined"!=typeof $&&$.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},a={a:"[aḀḁĂă\xc2\xe2ǍǎȺⱥȦȧẠạ\xc4\xe4\xc0\xe0\xc1\xe1Āā\xc3\xe3\xc5\xe5ąĄ\xc3ąĄ]",b:"[b␢βΒB฿\uD800\uDF01ᛒ]",c:"[cĆćĈĉČčĊċC̄c̄\xc7\xe7ḈḉȻȼƇƈɕᴄＣｃ]",d:"[dĎďḊḋḐḑḌḍḒḓḎḏĐđD̦d̦ƉɖƊɗƋƌᵭᶁᶑȡᴅＤｄ\xf0]",e:"[e\xc9\xe9\xc8\xe8\xca\xeaḘḙĚěĔĕẼẽḚḛẺẻĖė\xcb\xebĒēȨȩĘęᶒɆɇȄȅẾếỀềỄễỂểḜḝḖḗḔḕȆȇẸẹỆệⱸᴇＥｅɘǝƏƐε]",f:"[fƑƒḞḟ]",g:"[gɢ₲ǤǥĜĝĞğĢģƓɠĠġ]",h:"[hĤĥĦħḨḩẖẖḤḥḢḣɦʰǶƕ]",i:"[i\xcd\xed\xcc\xecĬĭ\xce\xeeǏǐ\xcf\xefḮḯĨĩĮįĪīỈỉȈȉȊȋỊịḬḭƗɨɨ̆ᵻᶖİiIıɪＩｉ]",j:"[jȷĴĵɈɉʝɟʲ]",k:"[kƘƙꝀꝁḰḱǨǩḲḳḴḵκϰ₭]",l:"[lŁłĽľĻļĹĺḶḷḸḹḼḽḺḻĿŀȽƚⱠⱡⱢɫɬᶅɭȴʟＬｌ]",n:"[nŃńǸǹŇň\xd1\xf1ṄṅŅņṆṇṊṋṈṉN̈n̈ƝɲȠƞᵰᶇɳȵɴＮｎŊŋ]",o:"[o\xd8\xf8\xd6\xf6\xd3\xf3\xd2\xf2\xd4\xf4ǑǒŐőŎŏȮȯỌọƟɵƠơỎỏŌō\xd5\xf5ǪǫȌȍՕօ]",p:"[pṔṕṖṗⱣᵽƤƥᵱ]",q:"[qꝖꝗʠɊɋꝘꝙq̃]",r:"[rŔŕɌɍŘřŖŗṘṙȐȑȒȓṚṛⱤɽ]",s:"[sŚśṠṡṢṣꞨꞩŜŝŠšŞşȘșS̈s̈]",t:"[tŤťṪṫŢţṬṭƮʈȚțṰṱṮṯƬƭ]",u:"[uŬŭɄʉỤụ\xdc\xfc\xda\xfa\xd9\xf9\xdb\xfbǓǔŰűŬŭƯưỦủŪūŨũŲųȔȕ∪]",v:"[vṼṽṾṿƲʋꝞꝟⱱʋ]",w:"[wẂẃẀẁŴŵẄẅẆẇẈẉ]",x:"[xẌẍẊẋχ]",y:"[y\xdd\xfdỲỳŶŷŸ\xffỸỹẎẏỴỵɎɏƳƴ]",z:"[zŹźẐẑŽžŻżẒẓẔẕƵƶ]"},l=function(){var t,e,i,n,s="",o={};for(i in a)if(a.hasOwnProperty(i))for(s+=n=a[i].substring(2,a[i].length-1),t=0,e=n.length;t<e;t++)o[n.charAt(t)]=i;var r=RegExp("["+s+"]","g");return function(t){return t.replace(r,function(t){return o[t]}).toLowerCase()}}();return t}),function(t,e){"function"==typeof define&&define.amd?define("microplugin",e):"object"==typeof exports?module.exports=e():t.MicroPlugin=e()}(this,function(){var t={};t.mixin=function(t){t.plugins={},t.prototype.initializePlugins=function(t){var i,n,s,o=this,r=[];if(o.plugins={names:[],settings:{},requested:{},loaded:{}},e.isArray(t))for(i=0,n=t.length;i<n;i++)"string"==typeof t[i]?r.push(t[i]):(o.plugins.settings[t[i].name]=t[i].options,r.push(t[i].name));else if(t)for(s in t)t.hasOwnProperty(s)&&(o.plugins.settings[s]=t[s],r.push(s));for(;r.length;)o.require(r.shift())},t.prototype.loadPlugin=function(e){var i=this.plugins,n=t.plugins[e];if(!t.plugins.hasOwnProperty(e))throw Error('Unable to find "'+e+'" plugin');i.requested[e]=!0,i.loaded[e]=n.fn.apply(this,[this.plugins.settings[e]||{}]),i.names.push(e)},t.prototype.require=function(t){var e=this.plugins;if(!this.plugins.loaded.hasOwnProperty(t)){if(e.requested[t])throw Error('Plugin has circular dependency ("'+t+'")');this.loadPlugin(t)}return e.loaded[t]},t.define=function(e,i){t.plugins[e]={name:e,fn:i}}};var e={isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}};return t}),function(t,e){"function"==typeof define&&define.amd?define("selectize",["jquery","sifter","microplugin"],e):"object"==typeof exports?module.exports=e(require("jquery"),require("sifter"),require("microplugin")):t.Selectize=e(t.jQuery,t.Sifter,t.MicroPlugin)}(this,function(t,e,i){"use strict";var n,s=function(t,e){if("string"!=typeof e||e.length){var i="string"==typeof e?RegExp(e,"i"):e,n=function(t){var e=0;if(3===t.nodeType){var s=t.data.search(i);if(s>=0&&t.data.length>0){var o=t.data.match(i),r=document.createElement("span");r.className="highlight",s>0&&" "===t.data[s-1]&&r.classList.add("extra-space-infront");var a=t.splitText(s);a.splitText(o[0].length);var l=a.cloneNode(!0);r.appendChild(l),a.parentNode.replaceChild(r,a),e=1}}else if(1===t.nodeType&&t.childNodes&&!/(script|style)/i.test(t.tagName)&&("highlight"!==t.className||"SPAN"!==t.tagName))for(var p=0;p<t.childNodes.length;++p)p+=n(t.childNodes[p]);return e};return t.each(function(){n(this)})}};t.fn.removeHighlight=function(){return this.find("span.highlight").each(function(){this.parentNode.firstChild.nodeName;var t=this.parentNode;t.replaceChild(this.firstChild,this),t.normalize()}).end()};var o=function(){};o.prototype={on:function(t,e){this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e)},off:function(t,e){var i=arguments.length;return 0===i?delete this._events:1===i?delete this._events[t]:void(this._events=this._events||{},t in this._events!=!1&&this._events[t].splice(this._events[t].indexOf(e),1))},trigger:function(t){if(this._events=this._events||{},t in this._events!=!1)for(var e=0;e<this._events[t].length;e++)this._events[t][e].apply(this,Array.prototype.slice.call(arguments,1))}},o.mixin=function(t){for(var e=["on","off","trigger"],i=0;i<e.length;i++)t.prototype[e[i]]=o.prototype[e[i]]};var r=/Mac/.test(navigator.userAgent),a=r?91:17,l=r?18:17,p=!/android/i.test(window.navigator.userAgent)&&!!document.createElement("input").validity,u=function(t){return void 0!==t},c=function(t){return null==t?null:"boolean"==typeof t?t?"1":"0":t+""},d=function(t){return(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},h={};h.before=function(t,e,i){var n=t[e];t[e]=function(){return i.apply(t,arguments),n.apply(t,arguments)}},h.after=function(t,e,i){var n=t[e];t[e]=function(){var e=n.apply(t,arguments);return i.apply(t,arguments),e}};var f=function(t){var e=!1;return function(){e||(e=!0,t.apply(this,arguments))}},g=function(t,e){var i;return function(){var n=this,s=arguments;window.clearTimeout(i),i=window.setTimeout(function(){t.apply(n,s)},e)}},v=function(t,e,i){var n,s=t.trigger,o={};for(n in t.trigger=function(){var i=arguments[0];if(-1===e.indexOf(i))return s.apply(t,arguments);o[i]=arguments},i.apply(t,[]),t.trigger=s,o)o.hasOwnProperty(n)&&s.apply(t,o[n])},m=function(t,e,i,n){t.on(e,i,function(e){for(var i=e.target;i&&i.parentNode!==t[0];)i=i.parentNode;return e.currentTarget=i,n.apply(this,[e])})},y=function(t){var e={};if("selectionStart"in t)e.start=t.selectionStart,e.length=t.selectionEnd-e.start;else if(document.selection){t.focus();var i=document.selection.createRange(),n=document.selection.createRange().text.length;i.moveStart("character",-t.value.length),e.start=i.text.length-n,e.length=n}return e},O=function(t,e,i){var n,s,o={};if(i)for(n=0,s=i.length;n<s;n++)o[i[n]]=t.css(i[n]);else o=t.css();e.css(o)},C=function(e){var i=null,n=function(n,s){var o,r,a,l,p,u,c,d,h,f;n=n||window.event||{},s=s||{},!n.metaKey&&!n.altKey&&(s.force||!1!==e.data("grow"))&&(o=e.val(),n.type&&"keydown"===n.type.toLowerCase()&&(a=(r=n.keyCode)>=48&&r<=57||r>=65&&r<=90||r>=96&&r<=111||r>=186&&r<=222||32===r,46===r||8===r?(d=y(e[0])).length?o=o.substring(0,d.start)+o.substring(d.start+d.length):8===r&&d.start?o=o.substring(0,d.start-1)+o.substring(d.start+1):46===r&&void 0!==d.start&&(o=o.substring(0,d.start)+o.substring(d.start+1)):a&&(u=n.shiftKey,c=String.fromCharCode(n.keyCode),o+=c=u?c.toUpperCase():c.toLowerCase())),l=e.attr("placeholder"),!o&&l&&(o=l),(p=(h=o,f=e,(h?(b.$testInput||(b.$testInput=t("<span />").css({position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}).appendTo("body")),b.$testInput.text(h),O(f,b.$testInput,["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"]),b.$testInput.width()):0)+4))!==i&&(i=p,e.width(p),e.triggerHandler("resize")))};e.on("keydown keyup update blur",n),n()},w=function(t){var e=document.createElement("div");return e.appendChild(t.cloneNode(!0)),e.innerHTML},b=function(i,n){var s,o,r,a,l=this;(a=i[0]).selectize=l;var p=window.getComputedStyle&&window.getComputedStyle(a,null);if(r=(r=p?p.getPropertyValue("direction"):a.currentStyle&&a.currentStyle.direction)||i.parents("[dir]:first").attr("dir")||"",t.extend(l,{order:0,settings:n,$input:i,tabIndex:i.attr("tabindex")||"",tagType:"select"===a.tagName.toLowerCase()?1:2,rtl:/rtl/i.test(r),eventNS:".selectize"+ ++b.count,highlightedValue:null,isBlurring:!1,isOpen:!1,isDisabled:!1,isRequired:i.is("[required]"),isInvalid:!1,isLocked:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,isShiftDown:!1,isCmdDown:!1,isCtrlDown:!1,ignoreFocus:!1,ignoreBlur:!1,ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:null===n.loadThrottle?l.onSearchChange:g(l.onSearchChange,n.loadThrottle)}),l.sifter=new e(this.options,{diacritics:n.diacritics}),l.settings.options){for(s=0,o=l.settings.options.length;s<o;s++)l.registerOption(l.settings.options[s]);delete l.settings.options}if(l.settings.optgroups){for(s=0,o=l.settings.optgroups.length;s<o;s++)l.registerOptionGroup(l.settings.optgroups[s]);delete l.settings.optgroups}l.settings.mode=l.settings.mode||(1===l.settings.maxItems?"single":"multi"),"boolean"!=typeof l.settings.hideSelected&&(l.settings.hideSelected="multi"===l.settings.mode),l.initializePlugins(l.settings.plugins),l.setupCallbacks(),l.setupTemplates(),l.setup()};if(o.mixin(b),void 0!==i)i.mixin(b);else{n={explanation:'Make sure you either: (1) are using the "standalone" version of Selectize, or (2) require MicroPlugin before you load Selectize.'},console.error("Selectize: Dependency MicroPlugin is missing"),n.explanation&&(console.group&&console.group(),console.error(n.explanation),console.group&&console.groupEnd())}return t.extend(b.prototype,{setup:function(){var e,i,n,s,o,u,c,d,h,f,g=this,v=g.settings,y=g.eventNS,O=t(window),w=t(document),b=g.$input;if(c=g.settings.mode,d=b.attr("class")||"",e=t("<div>").addClass(v.wrapperClass).addClass(d).addClass(c),i=t("<div>").addClass(v.inputClass).addClass("items").appendTo(e),n=t('<input type="text" autocomplete="off" />').appendTo(i).attr("tabindex",b.is(":disabled")?"-1":g.tabIndex),u=t(v.dropdownParent||e),s=t("<div>").addClass(v.dropdownClass).addClass(c).hide().appendTo(u),o=t("<div>").addClass(v.dropdownContentClass).appendTo(s),(f=b.attr("id"))&&(n.attr("id",f+"-selectized"),t("label[for='"+f+"']").attr("for",f+"-selectized")),g.settings.copyClassesToDropdown&&s.addClass(d),e.css({width:b[0].style.width}),g.plugins.names.length&&(h="plugin-"+g.plugins.names.join(" plugin-"),e.addClass(h),s.addClass(h)),(null===v.maxItems||v.maxItems>1)&&1===g.tagType&&b.attr("multiple","multiple"),g.settings.placeholder&&n.attr("placeholder",v.placeholder),!g.settings.splitOn&&g.settings.delimiter){var _=g.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");g.settings.splitOn=RegExp("\\s*"+_+"+\\s*")}b.attr("autocorrect")&&n.attr("autocorrect",b.attr("autocorrect")),b.attr("autocapitalize")&&n.attr("autocapitalize",b.attr("autocapitalize")),n[0].type=b[0].type,g.$wrapper=e,g.$control=i,g.$control_input=n,g.$dropdown=s,g.$dropdown_content=o,s.on("mouseenter mousedown click","[data-disabled]>[data-selectable]",function(t){t.stopImmediatePropagation()}),s.on("mouseenter","[data-selectable]",function(){return g.onOptionHover.apply(g,arguments)}),s.on("mousedown click","[data-selectable]",function(){return g.onOptionSelect.apply(g,arguments)}),m(i,"mousedown","*:not(input)",function(){return g.onItemSelect.apply(g,arguments)}),C(n),i.on({mousedown:function(){return g.onMouseDown.apply(g,arguments)},click:function(){return g.onClick.apply(g,arguments)}}),n.on({mousedown:function(t){t.stopPropagation()},keydown:function(){return g.onKeyDown.apply(g,arguments)},keyup:function(){return g.onKeyUp.apply(g,arguments)},keypress:function(){return g.onKeyPress.apply(g,arguments)},resize:function(){g.positionDropdown.apply(g,[])},blur:function(){return g.onBlur.apply(g,arguments)},focus:function(){return g.ignoreBlur=!1,g.onFocus.apply(g,arguments)},paste:function(){return g.onPaste.apply(g,arguments)}}),w.on("keydown"+y,function(t){g.isCmdDown=t[r?"metaKey":"ctrlKey"],g.isCtrlDown=t[r?"altKey":"ctrlKey"],g.isShiftDown=t.shiftKey}),w.on("keyup"+y,function(t){t.keyCode===l&&(g.isCtrlDown=!1),16===t.keyCode&&(g.isShiftDown=!1),t.keyCode===a&&(g.isCmdDown=!1)}),w.on("mousedown"+y,function(t){if(g.isFocused){if(t.target===g.$dropdown[0]||t.target.parentNode===g.$dropdown[0])return!1;g.$control.has(t.target).length||t.target===g.$control[0]||g.blur(t.target)}}),O.on(["scroll"+y,"resize"+y].join(" "),function(){g.isOpen&&g.positionDropdown.apply(g,arguments)}),O.on("mousemove"+y,function(){g.ignoreHover=!1}),this.revertSettings={$children:b.children().detach(),tabindex:b.attr("tabindex")},b.attr("tabindex",-1).hide().after(g.$wrapper),t.isArray(v.items)&&(g.setValue(v.items),delete v.items),p&&b.on("invalid"+y,function(t){t.preventDefault(),g.isInvalid=!0,g.refreshState()}),g.updateOriginalInput(),g.refreshItems(),g.refreshState(),g.updatePlaceholder(),g.isSetup=!0,b.is(":disabled")&&g.disable(),g.on("change",this.onChange),b.data("selectize",g),b.addClass("selectized"),g.trigger("initialize"),!0===v.preload&&g.onSearchChange("")},setupTemplates:function(){var e=this,i=e.settings.labelField,n=e.settings.optgroupLabelField;e.settings.render=t.extend({},{optgroup:function(t){return'<div class="optgroup">'+t.html+"</div>"},optgroup_header:function(t,e){return'<div class="optgroup-header">'+e(t[n])+"</div>"},option:function(t,e){return'<div class="option">'+e(t[i])+"</div>"},item:function(t,e){return'<div class="item">'+e(t[i])+"</div>"},option_create:function(t,e){return'<div class="create">Add <strong>'+e(t.input)+"</strong>&hellip;</div>"}},e.settings.render)},setupCallbacks:function(){var t,e,i={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(t in i)i.hasOwnProperty(t)&&(e=this.settings[i[t]])&&this.on(t,e)},onClick:function(t){this.isFocused&&this.isOpen||(this.focus(),t.preventDefault())},onMouseDown:function(e){var i=this,n=e.isDefaultPrevented();if(t(e.target),i.isFocused){if(e.target!==i.$control_input[0])return"single"===i.settings.mode?i.isOpen?i.close():i.open():n||i.setActiveItem(null),!1}else n||window.setTimeout(function(){i.focus()},0)},onChange:function(){this.$input.trigger("change")},onPaste:function(e){var i=this;if(i.isFull()||i.isInputHidden||i.isLocked){e.preventDefault();return}i.settings.splitOn&&setTimeout(function(){var e=i.$control_input.val();if(e.match(i.settings.splitOn))for(var n=t.trim(e).split(i.settings.splitOn),s=0,o=n.length;s<o;s++)i.createItem(n[s])},0)},onKeyPress:function(t){if(this.isLocked)return t&&t.preventDefault();var e=String.fromCharCode(t.keyCode||t.which);if(this.settings.create&&"multi"===this.settings.mode&&e===this.settings.delimiter)return this.createItem(),t.preventDefault(),!1},onKeyDown:function(t){t.target,this.$control_input[0];var e=this;if(e.isLocked){9!==t.keyCode&&t.preventDefault();return}switch(t.keyCode){case 65:if(e.isCmdDown){e.selectAll();return}break;case 27:e.isOpen&&(t.preventDefault(),t.stopPropagation(),e.close());return;case 78:if(!t.ctrlKey||t.altKey)break;case 40:if(!e.isOpen&&e.hasOptions)e.open();else if(e.$activeOption){e.ignoreHover=!0;var i=e.getAdjacentOption(e.$activeOption,1);i.length&&e.setActiveOption(i,!0,!0)}t.preventDefault();return;case 80:if(!t.ctrlKey||t.altKey)break;case 38:if(e.$activeOption){e.ignoreHover=!0;var n=e.getAdjacentOption(e.$activeOption,-1);n.length&&e.setActiveOption(n,!0,!0)}t.preventDefault();return;case 13:e.isOpen&&e.$activeOption&&(e.onOptionSelect({currentTarget:e.$activeOption}),t.preventDefault());return;case 37:e.advanceSelection(-1,t);return;case 39:e.advanceSelection(1,t);return;case 9:e.settings.selectOnTab&&e.isOpen&&e.$activeOption&&(e.onOptionSelect({currentTarget:e.$activeOption}),e.isFull()||t.preventDefault()),e.settings.create&&e.createItem()&&t.preventDefault();return;case 8:case 46:e.deleteSelection(t);return}if((e.isFull()||e.isInputHidden)&&!(r?t.metaKey:t.ctrlKey)){t.preventDefault();return}},onKeyUp:function(t){var e=this;if(e.isLocked)return t&&t.preventDefault();var i=e.$control_input.val()||"";e.lastValue!==i&&(e.lastValue=i,e.onSearchChange(i),e.refreshOptions(),e.trigger("type",i))},onSearchChange:function(t){var e=this,i=e.settings.load;i&&(e.loadedSearches.hasOwnProperty(t)||(e.loadedSearches[t]=!0,e.load(function(n){i.apply(e,[t,n])})))},onFocus:function(t){var e=this,i=e.isFocused;if(e.isDisabled)return e.blur(),t&&t.preventDefault(),!1;e.ignoreFocus||(e.isFocused=!0,"focus"===e.settings.preload&&e.onSearchChange(""),i||e.trigger("focus"),e.$activeItems.length||(e.showInput(),e.setActiveItem(null),e.refreshOptions(!!e.settings.openOnFocus)),e.refreshState())},onBlur:function(t,e){var i=this;if(i.isFocused){if(i.isFocused=!1,i.ignoreFocus)return;if(!i.ignoreBlur&&document.activeElement===i.$dropdown_content[0]){i.ignoreBlur=!0,i.onFocus(t);return}var n=function(){i.close(),i.setTextboxValue(""),i.setActiveItem(null),i.setActiveOption(null),i.setCaret(i.items.length),i.refreshState(),e&&e.focus&&e.focus(),i.isBlurring=!1,i.ignoreFocus=!1,i.trigger("blur")};i.isBlurring=!0,i.ignoreFocus=!0,i.settings.create&&i.settings.createOnBlur?i.createItem(null,!1,n):n()}},onOptionHover:function(t){this.ignoreHover||this.setActiveOption(t.currentTarget,!1)},onOptionSelect:function(e){var i,n,s=this;e.preventDefault&&(e.preventDefault(),e.stopPropagation()),(n=t(e.currentTarget)).hasClass("create")?s.createItem(null,function(){s.settings.closeAfterSelect&&s.close()}):void 0!==(i=n.attr("data-value"))&&(s.lastQuery=null,s.setTextboxValue(""),s.addItem(i),s.settings.closeAfterSelect?s.close():!s.settings.hideSelected&&e.type&&/mouse/.test(e.type)&&s.setActiveOption(s.getOption(i)))},onItemSelect:function(t){this.isLocked||"multi"!==this.settings.mode||(t.preventDefault(),this.setActiveItem(t.currentTarget,t))},load:function(t){var e=this,i=e.$wrapper.addClass(e.settings.loadingClass);e.loading++,t.apply(e,[function(t){e.loading=Math.max(e.loading-1,0),t&&t.length&&(e.addOption(t),e.refreshOptions(e.isFocused&&!e.isInputHidden)),e.loading||i.removeClass(e.settings.loadingClass),e.trigger("load",t)}])},setTextboxValue:function(t){var e=this.$control_input;e.val()!==t&&(e.val(t).triggerHandler("update"),this.lastValue=t)},getValue:function(){return 1===this.tagType&&this.$input.attr("multiple")?this.items:this.items.join(this.settings.delimiter)},setValue:function(t,e){v(this,e?[]:["change"],function(){this.clear(e),this.addItems(t,e)})},setActiveItem:function(e,i){var n,s,o,r,a,l,p,u,c=this;if("single"!==c.settings.mode){if(!(e=t(e)).length){t(c.$activeItems).removeClass("active"),c.$activeItems=[],c.isFocused&&c.showInput();return}if("mousedown"===(n=i&&i.type.toLowerCase())&&c.isShiftDown&&c.$activeItems.length){for(u=c.$control.children(".active:last"),(r=Array.prototype.indexOf.apply(c.$control[0].childNodes,[u[0]]))>(a=Array.prototype.indexOf.apply(c.$control[0].childNodes,[e[0]]))&&(p=r,r=a,a=p),s=r;s<=a;s++)l=c.$control[0].childNodes[s],-1===c.$activeItems.indexOf(l)&&(t(l).addClass("active"),c.$activeItems.push(l));i.preventDefault()}else"mousedown"===n&&c.isCtrlDown||"keydown"===n&&this.isShiftDown?e.hasClass("active")?(o=c.$activeItems.indexOf(e[0]),c.$activeItems.splice(o,1),e.removeClass("active")):c.$activeItems.push(e.addClass("active")[0]):(t(c.$activeItems).removeClass("active"),c.$activeItems=[e.addClass("active")[0]]);c.hideInput(),this.isFocused||c.focus()}},setActiveOption:function(e,i,n){var s,o,r,a,l,p=this;p.$activeOption&&p.$activeOption.removeClass("active"),p.$activeOption=null,(e=t(e)).length&&(p.$activeOption=e.addClass("active"),(i||!u(i))&&(s=p.$dropdown_content.height(),o=p.$activeOption.outerHeight(!0),i=p.$dropdown_content.scrollTop()||0,a=r=p.$activeOption.offset().top-p.$dropdown_content.offset().top+i,l=r-s+o,r+o>s+i?p.$dropdown_content.stop().animate({scrollTop:l},n?p.settings.scrollDuration:0):r<i&&p.$dropdown_content.stop().animate({scrollTop:a},n?p.settings.scrollDuration:0)))},selectAll:function(){var t=this;"single"!==t.settings.mode&&(t.$activeItems=Array.prototype.slice.apply(t.$control.children(":not(input)").addClass("active")),t.$activeItems.length&&(t.hideInput(),t.close()),t.focus())},hideInput:function(){var t=this;t.setTextboxValue(""),t.$control_input.css({opacity:0,position:"absolute",left:t.rtl?1e4:-1e4}),t.isInputHidden=!0},showInput:function(){this.$control_input.css({opacity:1,position:"relative",left:0}),this.isInputHidden=!1},focus:function(){var t=this;t.isDisabled||(t.ignoreFocus=!0,t.$control_input[0].focus(),window.setTimeout(function(){t.ignoreFocus=!1,t.onFocus()},0))},blur:function(t){this.$control_input[0].blur(),this.onBlur(null,t)},getScoreFunction:function(t){return this.sifter.getScoreFunction(t,this.getSearchOptions())},getSearchOptions:function(){var t=this.settings,e=t.sortField;return"string"==typeof e&&(e=[{field:e}]),{fields:t.searchField,conjunction:t.searchConjunction,sort:e,nesting:t.nesting}},search:function(e){var i,n,s,o=this,r=o.settings,a=this.getSearchOptions();if(r.score&&"function"!=typeof(s=o.settings.score.apply(this,[e])))throw Error('Selectize "score" setting must be a function that returns a function');if(e!==o.lastQuery?(o.lastQuery=e,n=o.sifter.search(e,t.extend(a,{score:s})),o.currentResults=n):n=t.extend(!0,{},o.currentResults),r.hideSelected)for(i=n.items.length-1;i>=0;i--)-1!==o.items.indexOf(c(n.items[i].id))&&n.items.splice(i,1);return n},refreshOptions:function(e){void 0===e&&(e=!0);var i,n,o,r,a,l,p,u,d,h,f,g,v,m,y,O,C=this,b=t.trim(C.$control_input.val()),_=C.search(b),x=C.$dropdown_content,I=C.$activeOption&&c(C.$activeOption.attr("data-value"));for(r=_.items.length,"number"==typeof C.settings.maxOptions&&(r=Math.min(r,C.settings.maxOptions)),a={},l=[],i=0;i<r;i++)for(n=0,p=C.options[_.items[i].id],u=C.render("option",p),d=p[C.settings.optgroupField]||"",o=(h=t.isArray(d)?d:[d])&&h.length;n<o;n++)d=h[n],C.optgroups.hasOwnProperty(d)||(d=""),a.hasOwnProperty(d)||(a[d]=document.createDocumentFragment(),l.push(d)),a[d].appendChild(u);for(this.settings.lockOptgroupOrder&&l.sort(function(t,e){var i;return(C.optgroups[t].$order||0)-(C.optgroups[e].$order||0)}),f=document.createDocumentFragment(),i=0,r=l.length;i<r;i++)d=l[i],C.optgroups.hasOwnProperty(d)&&a[d].childNodes.length?((g=document.createDocumentFragment()).appendChild(C.render("optgroup_header",C.optgroups[d])),g.appendChild(a[d]),f.appendChild(C.render("optgroup",t.extend({},C.optgroups[d],{html:w(g),dom:g})))):f.appendChild(a[d]);if(x.html(f),C.settings.highlight&&(x.removeHighlight(),_.query.length&&_.tokens.length))for(i=0,r=_.tokens.length;i<r;i++)s(x,_.tokens[i].regex);if(!C.settings.hideSelected)for(i=0,r=C.items.length;i<r;i++)C.getOption(C.items[i]).addClass("selected");(v=C.canCreate(b))&&(x.prepend(C.render("option_create",{input:b})),O=t(x[0].childNodes[0])),C.hasOptions=_.items.length>0||v,C.hasOptions?(_.items.length>0?((y=I&&C.getOption(I))&&y.length?m=y:"single"===C.settings.mode&&C.items.length&&(m=C.getOption(C.items[0])),m&&m.length||(m=O&&!C.settings.addPrecedence?C.getAdjacentOption(O,1):x.find("[data-selectable]:first"))):m=O,C.setActiveOption(m),e&&!C.isOpen&&C.open()):(C.setActiveOption(null),e&&C.isOpen&&C.close())},addOption:function(e){var i,n,s,o=this;if(t.isArray(e)){for(i=0,n=e.length;i<n;i++)o.addOption(e[i]);return}(s=o.registerOption(e))&&(o.userOptions[s]=!0,o.lastQuery=null,o.trigger("option_add",s,e))},registerOption:function(t){var e=c(t[this.settings.valueField]);return!(null==e||this.options.hasOwnProperty(e))&&(t.$order=t.$order||++this.order,this.options[e]=t,e)},registerOptionGroup:function(t){var e=c(t[this.settings.optgroupValueField]);return!!e&&(t.$order=t.$order||++this.order,this.optgroups[e]=t,e)},addOptionGroup:function(t,e){e[this.settings.optgroupValueField]=t,(t=this.registerOptionGroup(e))&&this.trigger("optgroup_add",t,e)},removeOptionGroup:function(t){this.optgroups.hasOwnProperty(t)&&(delete this.optgroups[t],this.renderCache={},this.trigger("optgroup_remove",t))},clearOptionGroups:function(){this.optgroups={},this.renderCache={},this.trigger("optgroup_clear")},updateOption:function(e,i){var n,s,o,r,a,l,p,u=this;if(e=c(e),o=c(i[u.settings.valueField]),null!==e&&u.options.hasOwnProperty(e)){if("string"!=typeof o)throw Error("Value must be set in option data");p=u.options[e].$order,o!==e&&(delete u.options[e],-1!==(r=u.items.indexOf(e))&&u.items.splice(r,1,o)),i.$order=i.$order||p,u.options[o]=i,a=u.renderCache.item,l=u.renderCache.option,a&&(delete a[e],delete a[o]),l&&(delete l[e],delete l[o]),-1!==u.items.indexOf(o)&&(n=u.getItem(e),s=t(u.render("item",i)),n.hasClass("active")&&s.addClass("active"),n.replaceWith(s)),u.lastQuery=null,u.isOpen&&u.refreshOptions(!1)}},removeOption:function(t,e){var i=this;t=c(t);var n=i.renderCache.item,s=i.renderCache.option;n&&delete n[t],s&&delete s[t],delete i.userOptions[t],delete i.options[t],i.lastQuery=null,i.trigger("option_remove",t),i.removeItem(t,e)},clearOptions:function(){var e=this;e.loadedSearches={},e.userOptions={},e.renderCache={};var i=e.options;t.each(e.options,function(t,n){-1==e.items.indexOf(t)&&delete i[t]}),e.options=e.sifter.items=i,e.lastQuery=null,e.trigger("option_clear")},getOption:function(t){return this.getElementWithValue(t,this.$dropdown_content.find("[data-selectable]"))},getAdjacentOption:function(e,i){var n=this.$dropdown.find("[data-selectable]"),s=n.index(e)+i;return s>=0&&s<n.length?n.eq(s):t()},getElementWithValue:function(e,i){if(null!=(e=c(e))){for(var n=0,s=i.length;n<s;n++)if(i[n].getAttribute("data-value")===e)return t(i[n])}return t()},getItem:function(t){return this.getElementWithValue(t,this.$control.children())},addItems:function(e,i){this.buffer=document.createDocumentFragment();for(var n=this.$control[0].childNodes,s=0;s<n.length;s++)this.buffer.appendChild(n[s]);for(var o=t.isArray(e)?e:[e],s=0,r=o.length;s<r;s++)this.isPending=s<r-1,this.addItem(o[s],i);var a=this.$control[0];a.insertBefore(this.buffer,a.firstChild),this.buffer=null},addItem:function(e,i){v(this,i?[]:["change"],function(){var n,s,o,r,a,l=this.settings.mode;if(e=c(e),-1!==this.items.indexOf(e)){"single"===l&&this.close();return}this.options.hasOwnProperty(e)&&("single"===l&&this.clear(i),"multi"===l&&this.isFull()||(n=t(this.render("item",this.options[e])),a=this.isFull(),this.items.splice(this.caretPos,0,e),this.insertAtCaret(n),(!this.isPending||!a&&this.isFull())&&this.refreshState(),this.isSetup&&(o=this.$dropdown_content.find("[data-selectable]"),!this.isPending&&(s=this.getOption(e),r=this.getAdjacentOption(s,1).attr("data-value"),this.refreshOptions(this.isFocused&&"single"!==l),r&&this.setActiveOption(this.getOption(r))),!o.length||this.isFull()?this.close():this.isPending||this.positionDropdown(),this.updatePlaceholder(),this.trigger("item_add",e,n),this.isPending||this.updateOriginalInput({silent:i}))))})},removeItem:function(e,i){var n,s,o,r=this;e=c((n=e instanceof t?e:r.getItem(e)).attr("data-value")),-1!==(s=r.items.indexOf(e))&&(n.remove(),n.hasClass("active")&&(o=r.$activeItems.indexOf(n[0]),r.$activeItems.splice(o,1)),r.items.splice(s,1),r.lastQuery=null,!r.settings.persist&&r.userOptions.hasOwnProperty(e)&&r.removeOption(e,i),s<r.caretPos&&r.setCaret(r.caretPos-1),r.refreshState(),r.updatePlaceholder(),r.updateOriginalInput({silent:i}),r.positionDropdown(),r.trigger("item_remove",e,n))},createItem:function(e,i){var n=this,s=n.caretPos;e=e||t.trim(n.$control_input.val()||"");var o=arguments[arguments.length-1];if("function"!=typeof o&&(o=function(){}),"boolean"!=typeof i&&(i=!0),!n.canCreate(e))return o(),!1;n.lock();var r="function"==typeof n.settings.create?this.settings.create:function(t){var e={};return e[n.settings.labelField]=t,e[n.settings.valueField]=t,e},a=f(function(t){if(n.unlock(),!t||"object"!=typeof t)return o();var e=c(t[n.settings.valueField]);if("string"!=typeof e)return o();n.setTextboxValue(""),n.addOption(t),n.setCaret(s),n.addItem(e),n.refreshOptions(i&&"single"!==n.settings.mode),o(t)}),l=r.apply(this,[e,a]);return void 0!==l&&a(l),!0},refreshItems:function(){this.lastQuery=null,this.isSetup&&this.addItem(this.items),this.refreshState(),this.updateOriginalInput()},refreshState:function(){this.refreshValidityState(),this.refreshClasses()},refreshValidityState:function(){if(!this.isRequired)return!1;var t=!this.items.length;this.isInvalid=t,this.$control_input.prop("required",t),this.$input.prop("required",!t)},refreshClasses:function(){var e=this.isFull(),i=this.isLocked;this.$wrapper.toggleClass("rtl",this.rtl),this.$control.toggleClass("focus",this.isFocused).toggleClass("disabled",this.isDisabled).toggleClass("required",this.isRequired).toggleClass("invalid",this.isInvalid).toggleClass("locked",i).toggleClass("full",e).toggleClass("not-full",!e).toggleClass("input-active",this.isFocused&&!this.isInputHidden).toggleClass("dropdown-active",this.isOpen).toggleClass("has-options",!t.isEmptyObject(this.options)).toggleClass("has-items",this.items.length>0),this.$control_input.data("grow",!e&&!i)},isFull:function(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(t){var e,i,n,s;if(t=t||{},1===this.tagType){for(e=0,n=[],i=this.items.length;e<i;e++)s=this.options[this.items[e]][this.settings.labelField]||"",n.push('<option value="'+d(this.items[e])+'" selected="selected">'+d(s)+"</option>");n.length||this.$input.attr("multiple")||n.push('<option value="" selected="selected"></option>'),this.$input.html(n.join(""))}else this.$input.val(this.getValue()),this.$input.attr("value",this.$input.val());this.isSetup&&!t.silent&&this.trigger("change",this.$input.val())},updatePlaceholder:function(){if(this.settings.placeholder){var t=this.$control_input;this.items.length?t.removeAttr("placeholder"):t.attr("placeholder",this.settings.placeholder),t.triggerHandler("update",{force:!0})}},open:function(){var t=this;t.isLocked||t.isOpen||"multi"===t.settings.mode&&t.isFull()||(t.focus(),t.isOpen=!0,t.refreshState(),t.$dropdown.css({visibility:"hidden",display:"block"}),t.positionDropdown(),t.$dropdown.css({visibility:"visible"}),t.trigger("dropdown_open",t.$dropdown))},close:function(){var t=this,e=t.isOpen;"single"===t.settings.mode&&t.items.length&&(t.hideInput(),t.isBlurring||t.$control_input.blur()),t.isOpen=!1,t.$dropdown.hide(),t.setActiveOption(null),t.refreshState(),e&&t.trigger("dropdown_close",t.$dropdown)},positionDropdown:function(){var t=this.$control,e="body"===this.settings.dropdownParent?t.offset():t.position();e.top+=t.outerHeight(!0),this.$dropdown.css({width:t[0].getBoundingClientRect().width,top:e.top,left:e.left})},clear:function(t){var e=this;e.items.length&&(e.$control.children(":not(input)").remove(),e.items=[],e.lastQuery=null,e.setCaret(0),e.setActiveItem(null),e.updatePlaceholder(),e.updateOriginalInput({silent:t}),e.refreshState(),e.showInput(),e.trigger("clear"))},insertAtCaret:function(t){var e=Math.min(this.caretPos,this.items.length),i=t[0],n=this.buffer||this.$control[0];0===e?n.insertBefore(i,n.firstChild):n.insertBefore(i,n.childNodes[e]),this.setCaret(e+1)},deleteSelection:function(e){var i,n,s,o,r,a,l,p,u;if(s=e&&8===e.keyCode?-1:1,o=y(this.$control_input[0]),this.$activeOption&&!this.settings.hideSelected&&(l=this.getAdjacentOption(this.$activeOption,-1).attr("data-value")),r=[],this.$activeItems.length){for(u=this.$control.children(".active:"+(s>0?"last":"first")),a=this.$control.children(":not(input)").index(u),s>0&&a++,i=0,n=this.$activeItems.length;i<n;i++)r.push(t(this.$activeItems[i]).attr("data-value"));e&&(e.preventDefault(),e.stopPropagation())}else(this.isFocused||"single"===this.settings.mode)&&this.items.length&&(s<0&&0===o.start&&0===o.length?r.push(this.items[this.caretPos-1]):s>0&&o.start===this.$control_input.val().length&&r.push(this.items[this.caretPos]));if(!r.length||"function"==typeof this.settings.onDelete&&!1===this.settings.onDelete.apply(this,[r]))return!1;for(void 0!==a&&this.setCaret(a);r.length;)this.removeItem(r.pop());return this.showInput(),this.positionDropdown(),this.refreshOptions(!0),l&&(p=this.getOption(l)).length&&this.setActiveOption(p),!0},advanceSelection:function(t,e){var i,n,s,o,r,a;0!==t&&(this.rtl&&(t*=-1),i=t>0?"last":"first",n=y(this.$control_input[0]),this.isFocused&&!this.isInputHidden?(o=this.$control_input.val().length,(r=t<0?0===n.start&&0===n.length:n.start===o)&&!o&&this.advanceCaret(t,e)):(a=this.$control.children(".active:"+i)).length&&(s=this.$control.children(":not(input)").index(a),this.setActiveItem(null),this.setCaret(t>0?s+1:s)))},advanceCaret:function(t,e){var i,n;0!==t&&(i=t>0?"next":"prev",this.isShiftDown?(n=this.$control_input[i]()).length&&(this.hideInput(),this.setActiveItem(n),e&&e.preventDefault()):this.setCaret(this.caretPos+t))},setCaret:function(e){var i,n,s,o,r=this;if(e="single"===r.settings.mode?r.items.length:Math.max(0,Math.min(r.items.length,e)),!r.isPending)for(i=0,n=(s=r.$control.children(":not(input)")).length;i<n;i++)o=t(s[i]).detach(),i<e?r.$control_input.before(o):r.$control.append(o);r.caretPos=e},lock:function(){this.close(),this.isLocked=!0,this.refreshState()},unlock:function(){this.isLocked=!1,this.refreshState()},disable:function(){var t=this;t.$input.prop("disabled",!0),t.$control_input.prop("disabled",!0).prop("tabindex",-1),t.isDisabled=!0,t.lock()},enable:function(){var t=this;t.$input.prop("disabled",!1),t.$control_input.prop("disabled",!1).prop("tabindex",t.tabIndex),t.isDisabled=!1,t.unlock()},destroy:function(){var e=this.eventNS,i=this.revertSettings;this.trigger("destroy"),this.off(),this.$wrapper.remove(),this.$dropdown.remove(),this.$input.html("").append(i.$children).removeAttr("tabindex").removeClass("selectized").attr({tabindex:i.tabindex}).show(),this.$control_input.removeData("grow"),this.$input.removeData("selectize"),0==--b.count&&b.$testInput&&(b.$testInput.remove(),b.$testInput=void 0),t(window).off(e),t(document).off(e),t(document.body).off(e),delete this.$input[0].selectize},render:function(e,i){var n,s,o="",r=!1,a=this;return(("option"===e||"item"===e)&&(r=!!(n=c(i[a.settings.valueField]))),r&&(u(a.renderCache[e])||(a.renderCache[e]={}),a.renderCache[e].hasOwnProperty(n)))?a.renderCache[e][n]:(o=t(a.settings.render[e].apply(this,[i,d])),"option"===e||"option_create"===e?i[a.settings.disabledField]||o.attr("data-selectable",""):"optgroup"===e&&(s=i[a.settings.optgroupValueField]||"",o.attr("data-group",s),i[a.settings.disabledField]&&o.attr("data-disabled","")),("option"===e||"item"===e)&&o.attr("data-value",n||""),r&&(a.renderCache[e][n]=o[0]),o[0])},clearCache:function(t){var e=this;void 0===t?e.renderCache={}:delete e.renderCache[t]},canCreate:function(t){if(!this.settings.create)return!1;var e=this.settings.createFilter;return t.length&&("function"!=typeof e||e.apply(this,[t]))&&("string"!=typeof e||RegExp(e).test(t))&&(!(e instanceof RegExp)||e.test(t))}}),b.count=0,b.defaults={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:!1,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:1e3,maxItems:null,hideSelected:null,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,closeAfterSelect:!1,scrollDuration:60,loadThrottle:300,loadingClass:"loading",dataAttr:"data-data",optgroupField:"optgroup",valueField:"value",labelField:"text",disabledField:"disabled",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"selectize-control",inputClass:"selectize-input",dropdownClass:"selectize-dropdown",dropdownContentClass:"selectize-dropdown-content",dropdownParent:null,copyClassesToDropdown:!0,render:{}},t.fn.selectize=function(e){var i=t.fn.selectize.defaults,n=t.extend({},i,e),s=n.dataAttr,o=n.labelField,r=n.valueField,a=n.disabledField,l=n.optgroupField,p=n.optgroupLabelField,u=n.optgroupValueField,d=function(e,i){var a,l,p,u,c=e.attr(s);if(c)for(a=0,i.options=JSON.parse(c),l=i.options.length;a<l;a++)i.items.push(i.options[a][r]);else{var d=t.trim(e.val()||"");if(!n.allowEmptyOption&&!d.length)return;for(a=0,l=(p=d.split(n.delimiter)).length;a<l;a++)(u={})[o]=p[a],u[r]=p[a],i.options.push(u);i.items=p}},h=function(e,i){var d,h,f,g,v=i.options,m={},y=function(t){var e=s&&t.attr(s);return"string"==typeof e&&e.length?JSON.parse(e):null},O=function(e,s){e=t(e);var p=c(e.val());if(p||n.allowEmptyOption){if(m.hasOwnProperty(p)){if(s){var u=m[p][l];u?t.isArray(u)?u.push(s):m[p][l]=[u,s]:m[p][l]=s}return}var d=y(e)||{};d[o]=d[o]||e.text(),d[r]=d[r]||p,d[a]=d[a]||e.prop("disabled"),d[l]=d[l]||s,m[p]=d,v.push(d),e.is(":selected")&&i.items.push(p)}};for(d=0,i.maxItems=e.attr("multiple")?null:1,h=(g=e.children()).length;d<h;d++)"optgroup"===(f=g[d].tagName.toLowerCase())?function(e){var n,s,o,r,l;for((o=(e=t(e)).attr("label"))&&((r=y(e)||{})[p]=o,r[u]=o,r[a]=e.prop("disabled"),i.optgroups.push(r)),l=t("option",e),n=0,s=l.length;n<s;n++)O(l[n],o)}(g[d]):"option"===f&&O(g[d])};return this.each(function(){if(!this.selectize){var s,o=t(this),r=this.tagName.toLowerCase(),a=o.attr("placeholder")||o.attr("data-placeholder");a||n.allowEmptyOption||(a=o.children('option[value=""]').text());var l={placeholder:a,options:[],optgroups:[],items:[]};"select"===r?h(o,l):d(o,l),s=new b(o,t.extend(!0,{},i,l,e))}})},t.fn.selectize.defaults=b.defaults,t.fn.selectize.support={validity:p},b.define("drag_drop",function(e){if(!t.fn.sortable)throw Error('The "drag_drop" plugin requires jQuery UI "sortable".');if("multi"===this.settings.mode){var i,n,s,o=this;o.lock=(i=o.lock,function(){var t=o.$control.data("sortable");return t&&t.disable(),i.apply(o,arguments)}),o.unlock=(n=o.unlock,function(){var t=o.$control.data("sortable");return t&&t.enable(),n.apply(o,arguments)}),o.setup=(s=o.setup,function(){s.apply(this,arguments);var e=o.$control.sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:o.isLocked,start:function(t,i){i.placeholder.css("width",i.helper.css("width")),e.css({overflow:"visible"})},stop:function(){e.css({overflow:"hidden"});var i=o.$activeItems?o.$activeItems.slice():null,n=[];e.children("[data-value]").each(function(){n.push(t(this).attr("data-value"))}),o.setValue(n),o.setActiveItem(i)}})})}}),b.define("dropdown_header",function(e){var i,n=this;e=t.extend({title:"Untitled",headerClass:"selectize-dropdown-header",titleRowClass:"selectize-dropdown-header-title",labelClass:"selectize-dropdown-header-label",closeClass:"selectize-dropdown-header-close",html:function(t){return'<div class="'+t.headerClass+'"><div class="'+t.titleRowClass+'"><span class="'+t.labelClass+'">'+t.title+'</span><a href="javascript:void(0)" class="'+t.closeClass+'">&times;</a></div></div>'}},e),n.setup=(i=n.setup,function(){i.apply(n,arguments),n.$dropdown_header=t(e.html(e)),n.$dropdown.prepend(n.$dropdown_header)})}),b.define("optgroup_columns",function(e){var i,n=this;e=t.extend({equalizeWidth:!0,equalizeHeight:!0},e),this.getAdjacentOption=function(e,i){var n=e.closest("[data-group]").find("[data-selectable]"),s=n.index(e)+i;return s>=0&&s<n.length?n.eq(s):t()},this.onKeyDown=(i=n.onKeyDown,function(t){var e,s,o,r;if(this.isOpen&&(37===t.keyCode||39===t.keyCode)){n.ignoreHover=!0,e=(r=this.$activeOption.closest("[data-group]")).find("[data-selectable]").index(this.$activeOption),(s=(o=(r=37===t.keyCode?r.prev("[data-group]"):r.next("[data-group]")).find("[data-selectable]")).eq(Math.min(o.length-1,e))).length&&this.setActiveOption(s);return}return i.apply(this,arguments)});var s=function(){var t,e=s.width,i=document;return void 0===e&&((t=i.createElement("div")).innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>',t=t.firstChild,i.body.appendChild(t),e=s.width=t.offsetWidth-t.clientWidth,i.body.removeChild(t)),e},o=function(){var i,o,r,a,l,p,u;if((o=(u=t("[data-group]",n.$dropdown_content)).length)&&n.$dropdown_content.width()){if(e.equalizeHeight){for(i=0,r=0;i<o;i++)r=Math.max(r,u.eq(i).height());u.css({height:r})}e.equalizeWidth&&(a=Math.round((p=n.$dropdown_content.innerWidth()-s())/o),u.css({width:a}),o>1&&(l=p-a*(o-1),u.eq(o-1).css({width:l})))}};(e.equalizeHeight||e.equalizeWidth)&&(h.after(this,"positionDropdown",o),h.after(this,"refreshOptions",o))}),b.define("remove_button",function(e){var i,n,s,o,r,a,l,p,u,c,h;if(e=t.extend({label:"&times;",title:"Remove",className:"remove",append:!0},e),"single"===this.settings.mode){i=this,(n=e).className="remove-single",s=i,o='<a href="javascript:void(0)" class="'+n.className+'" tabindex="-1" title="'+d(n.title)+'">'+n.label+"</a>",i.setup=(r=s.setup,function(){if(n.append){var e=t(s.$input.context).attr("id");t("#"+e);var a=s.settings.render.item;s.settings.render.item=function(e){var n,s;return n=a.apply(i,arguments),s=o,t("<span>").append(n).append(s)}}r.apply(i,arguments),i.$control.on("click","."+n.className,function(t){t.preventDefault(),s.isLocked||s.clear()})});return}a=this,l=e,p=a,u='<a href="javascript:void(0)" class="'+l.className+'" tabindex="-1" title="'+d(l.title)+'">'+l.label+"</a>",c=function(t,e){var i=t.search(/(<\/[^>]+>\s*)$/);return t.substring(0,i)+e+t.substring(i)},a.setup=(h=p.setup,function(){if(l.append){var e=p.settings.render.item;p.settings.render.item=function(t){return c(e.apply(a,arguments),u)}}h.apply(a,arguments),a.$control.on("click","."+l.className,function(e){if(e.preventDefault(),!p.isLocked){var i=t(e.currentTarget).parent();p.setActiveItem(i),p.deleteSelection()&&p.setCaret(p.items.length)}})})}),b.define("restore_on_backspace",function(t){var e;t.text=t.text||function(t){return t[this.settings.labelField]},this.onKeyDown=(e=this.onKeyDown,function(i){var n,s;if(8===i.keyCode&&""===this.$control_input.val()&&!this.$activeItems.length&&(n=this.caretPos-1)>=0&&n<this.items.length){s=this.options[this.items[n]],this.deleteSelection(i)&&(this.setTextboxValue(t.text.apply(this,[s])),this.refreshOptions(!0)),i.preventDefault();return}return e.apply(this,arguments)})}),b});